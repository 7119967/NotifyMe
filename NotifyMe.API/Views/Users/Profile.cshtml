@using Microsoft.AspNetCore.Identity
@inject SignInManager<User> SignInManager
@inject UserManager<User> UserManager
@{
    var user = await UserManager.GetUserAsync(User);
}
@model ProfileViewModel
@{
    ViewBag.Title = "Профиль";
    Layout = "_Layout";
    bool subcribeExist = false;
}
<h2>Профиль @Model.UserName</h2>
<hr/>
<div class="card mb-3 col-9">
    <div class="row">
        <div class="col-md-4" style="padding-top: 15px;">
            <span style="text-align: center;">
                <img class="rounded-circle" src="@Model.Avatar" alt="@Model.UserName" style="width: 100px; height: 100px;display: block;margin: auto;">
            </span>
        </div>
        <div class="col-md-8">
            <div class="card-body">
                <div class="row">
                    <div class="col">
                        <label asp-for="UserName" class="control-label" style="font-size: 20px;">@Model.UserName</label>
                    </div>
                </div>
                <div class="row">
                    @* <div class="col-4"> *@
                    @*     <label asp-for="PostsCounter" class="control-label"><strong>@Model.PostsCounter</strong> публикаций</label> *@
                    @* </div> *@
                    @* <div class="col-4"> *@
                    @*     <label asp-for="FollowersCounter" class="control-label"><strong>@Model.FollowersCounter</strong> подписчиков</label> *@
                    @* </div> *@
                    @* <div class="col-4"> *@
                    @*     <label asp-for="SubscribesCounter" class="control-label"><strong>@Model.SubscribesCounter</strong> подписок</label> *@
                    @* </div> *@
                </div>
                <div class="row">
                    <div class="col-6">
                        <label asp-for="UserName" class="control-label">@Model.UserName</label>
                    </div>     
                    <div class="col-6">
                        <label asp-for="FirstName" class="control-label">@Model.FirstName</label>
                    </div>     
                    <div class="col-6">
                        <label asp-for="LastName" class="control-label">@Model.LastName</label>
                    </div>     
                    <div class="col-6">
                        <label asp-for="Email" class="control-label">@Model.Email</label>
                    </div>           
                    <div class="col-6">
                        <label asp-for="PhoneNumber" class="control-label">@Model.PhoneNumber</label>
                    </div>
                    <div class="col-6">
                        <label asp-for="Info" class="control-label">@Model.Info</label>
                    </div>
                </div>
                <div class="row">
                    @* @foreach (Subscribe item in ViewBag.Subcribers) *@
                    @* { *@
                    @*     @if (item.SubcriberId == Model.Id) *@
                    @*     { *@
                    @*         subcribeExist = true; *@
                    @*     } *@
                    @* } *@
                    
                    @if (UserManager.GetUserId(User) == Model.Id.ToString())
                    {
                        <div class="col-6">
                            <a class="btn btn-outline-primary"
                               asp-action="Edit" 
                               asp-controller="Users" 
                               asp-route-idCurrentUser="@Model.Id">Редактировать профиль</a>
                        </div>
                    }
                    else if (subcribeExist)
                    {
                        <div class="col-6">
                            <button id="unsubcribing" 
                                    class="btn btn-outline-primary" 
                                    onclick="unsubcribing('@Model.Id', '@user.Id')">Отписаться</button>
                        </div>
                    }
                    else
                    {
                        <div class="col-6">
                            <button id="subcribing" 
                                    class="btn btn-outline-primary" 
                                    onclick="subcribing('@Model.Id', '@user.Id')">Подписаться</button>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row mt-5 mb-2">
    @{
        await Html.RenderPartialAsync("PartialViews/PostsViewablePartialView");
        Html.Hidden("Id", Model.Id);
    }
</div>

@section Scripts
{
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <script>
        function unsubcribing(idSubscribe, idCurrentUser) {

         }
         
        function subcribing(idSubscribe, idCurrentUser) {

         }
         
         function deleting(idPost, UserId) {

          }

            function editing(idPost) {

            }
    </script>
}